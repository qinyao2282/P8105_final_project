---

title: "Shiny Dashboard"

output: 

  flexdashboard::flex_dashboard:

    orientation: columns

    vertical_layout: fill

runtime: shiny

---



```{r setup, include=FALSE}

library(flexdashboard)

library(tidyverse)

library(viridis)

library(p8105.datasets)

library(plotly)

```


```{r}
final_data = read_csv("./data/final_data.csv")

variable = list("obesity_percentage", "stroke_value", "pm2.5", "tobacco_consumption", "median_income")
```



Column {.sidebar}

-----------------------------------------------------------------------



```{r}

# selectInput widget

selectInput("variable_choice", label = h3("Select variable"),

            choices = variable, selected = "obesity_percentage")

```

Column {data-width=650}
-----------------------------------------------------------------------



### Variable distribution



```{r}

renderPlotly({ 
  
  variable_name = as.character(input$variable_choice)
  
  plot_data = final_data %>%
    select(variable_name, mortality_rate)
  
  colnames(plot_data) = c("variable_value", "mortality_rate")
  
  plot_data = plot_data %>%
     mutate(text_label = str_c(variable_name, ": ", variable_value, '\nMortality rate: ', mortality_rate))
  
  plot_data %>%

  plot_ly(x = ~ variable_value, y = ~mortality_rate, type = "scatter", mode = "markers",
          alpha = 0.5,
          text = ~text_label) %>%
    layout(xaxis = list(title = variable_name),
           yaxis = list(title = "Mortality Rate"))
})

```




Column {data-width=350}

-----------------------------------------------------------------------
